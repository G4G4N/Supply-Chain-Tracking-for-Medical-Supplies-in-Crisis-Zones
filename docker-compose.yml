# @Author: Mukhil Sundararaj
# @Date:   2025-11-25 17:24:45
# @Last Modified by:   Mukhil Sundararaj
# @Last Modified time: 2025-11-25 17:44:16
version: '3.8'

services:
  dapp:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        REACT_APP_CONTRACT_ADDRESS: ${REACT_APP_CONTRACT_ADDRESS:-}
        REACT_APP_NETWORK: ${REACT_APP_NETWORK:-sepolia}
        REACT_APP_ENABLE_ANALYTICS: ${REACT_APP_ENABLE_ANALYTICS:-false}
        REACT_APP_ENABLE_ERROR_TRACKING: ${REACT_APP_ENABLE_ERROR_TRACKING:-false}
        REACT_APP_SENTRY_DSN: ${REACT_APP_SENTRY_DSN:-}
    ports:
      - "3000:80"
    environment:
      - NODE_ENV=production
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost/health"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 5s
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.dapp.rule=Host(`localhost`)"
      - "traefik.http.services.dapp.loadbalancer.server.port=80"

volumes:
  dapp_data:

